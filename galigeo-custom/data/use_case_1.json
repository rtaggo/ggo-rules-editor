{
  "contentType": "application/vnd.gorules.decision",
  "nodes": [
    {
      "type": "inputNode",
      "id": "808430da-4cf5-47a7-8fb0-5061fc5efa33",
      "name": "customer",
      "position": {
        "x": -310,
        "y": 70
      }
    },
    {
      "type": "switchNode",
      "content": {
        "hitPolicy": "first",
        "statements": [
          {
            "id": "993b48ec-daa0-483c-a58f-a49c451afea4",
            "condition": "customer.brand == \"redken\"",
            "isDefault": false
          },
          {
            "id": "d57dc7c1-1968-4f49-91ee-3b99b0fe6480",
            "condition": "customer.brand in [\"l'oreal pro\", \"kerastase\", \"shu uemura pro\"]",
            "isDefault": false
          },
          {
            "id": "831bbd95-677f-4005-a71c-215fb4d12308",
            "condition": "",
            "isDefault": false
          }
        ]
      },
      "id": "84b2b5e6-846b-44cb-bd18-264a35cc7b90",
      "name": "Brand switch",
      "position": {
        "x": 5,
        "y": 210
      }
    },
    {
      "type": "functionNode",
      "content": {
        "source": "import zen from 'zen';\r\n\r\nexport const handler = async (input) => {\r\n  console.log(input);\r\n  return { \"user\": {name: input?.territory?.stakeholder ?? 'Unassigned'}};\r\n};\r\n"
      },
      "id": "1fc3f0ab-edce-4469-950e-c24299bb4030",
      "name": "US_brands",
      "position": {
        "x": 335,
        "y": 160
      }
    },
    {
      "type": "functionNode",
      "content": {
        "source": "import zen from 'zen';\r\n\r\nexport const handler = async (input) => {\r\n  console.log(input);\r\n  const {territory} = input;\r\n  return { \"user\": {name : input?.territory?.stakeholder ?? 'Galigeo'}};\r\n};\r\n "
      },
      "id": "bd32d1bd-a6ad-445c-b64c-8d877785a0d1",
      "name": "Territory Stackholder",
      "position": {
        "x": 1080,
        "y": 230
      }
    },
    {
      "type": "functionNode",
      "content": {
        "source": "import zen from 'zen';\r\n\r\nexport const handler = async (input) => {\r\n  console.log(input);\r\n  const failed_assignment = {\r\n    error: true, \r\n    reason: 'UNKNOWN BRAND',\r\n    message: 'Customer brand may not be in list'\r\n  }\r\n  return { ...input, ...failed_assignment};\r\n};\r\n"
      },
      "id": "8bd6f144-e3dc-44b2-b98e-024e440be7b7",
      "name": "Unknown brand",
      "position": {
        "x": 330,
        "y": 515
      }
    },
    {
      "type": "outputNode",
      "id": "a5f6f0b5-cba9-4887-9e85-34bc1d348053",
      "name": "response",
      "position": {
        "x": 1410,
        "y": 305
      }
    },
    {
      "type": "decisionTableNode",
      "content": {
        "hitPolicy": "first",
        "inputs": [
          {
            "id": "a69de336-d773-4825-bdb8-24054259e03f",
            "name": "Customer Id",
            "field": "customer.id"
          }
        ],
        "outputs": [
          {
            "id": "27498e55-6f63-42a8-82ae-70edac214f3e",
            "name": "User assigned",
            "field": "user.name"
          },
          {
            "id": "2a4b7089-235c-490c-b226-21a999b3797f",
            "field": "territory",
            "name": "Territory"
          },
          {
            "id": "da43ec09-476d-4cb1-b059-292b985d4468",
            "field": "exception_details.code",
            "name": "Exception details code"
          },
          {
            "id": "e6fa52a4-164a-494b-b82c-d9338d24aa17",
            "field": "exception_details.message",
            "name": "Exception details message"
          }
        ],
        "rules": [
          {
            "_id": "16558146-3a37-4c98-87fd-252cead1d3e8",
            "a69de336-d773-4825-bdb8-24054259e03f": "'100551679', '100551691', '100563199'",
            "27498e55-6f63-42a8-82ae-70edac214f3e": "'Emma'",
            "2a4b7089-235c-490c-b226-21a999b3797f": "territory",
            "da43ec09-476d-4cb1-b059-292b985d4468": "'FR_EXCEPTION'",
            "e6fa52a4-164a-494b-b82c-d9338d24aa17": "'Force Assigned to Emma based on Customer ID'"
          },
          {
            "_id": "73b5a225-bf70-48d3-86a9-5bbd3cd5e4e4",
            "a69de336-d773-4825-bdb8-24054259e03f": "",
            "27498e55-6f63-42a8-82ae-70edac214f3e": "null",
            "2a4b7089-235c-490c-b226-21a999b3797f": "territory",
            "da43ec09-476d-4cb1-b059-292b985d4468": "",
            "e6fa52a4-164a-494b-b82c-d9338d24aa17": ""
          }
        ]
      },
      "id": "32ec2919-9a0c-4e95-8931-a378c4eb727e",
      "name": "FR_Exceptions",
      "position": {
        "x": 330,
        "y": 330
      }
    },
    {
      "type": "switchNode",
      "content": {
        "hitPolicy": "first",
        "statements": [
          {
            "id": "373ecbf9-fbb2-4261-a8d2-18ab634d6cbe",
            "condition": "user.name == null",
            "isDefault": false
          },
          {
            "id": "8019b1a5-cf97-479f-9b65-795d5f9b62a8",
            "condition": "",
            "isDefault": true
          }
        ]
      },
      "id": "c8bb6bb8-a695-4663-9a83-1cf77d50b678",
      "name": "FR assigned?",
      "position": {
        "x": 710,
        "y": 235
      }
    },
    {
      "type": "functionNode",
      "content": {
        "source": "import zen from 'zen';\r\n\r\nexport const handler = async (input) => {\r\n  /*\r\n  const customer = input?.customer ?? {};\r\n  customer.brand = (customer?.brand ?? '').toLowerCase();\r\n  console.log(customer)\r\n  return {...input, customer};\r\n  */\r\n  if (input?.customer?.brand) {\r\n    input.customer.brand = input.customer.brand.toLowerCase()\r\n  }\r\n  return input\r\n}"
      },
      "id": "bc18866a-d4f9-4fff-9e2d-3c73a9a557f5",
      "name": "Prepare input",
      "position": {
        "x": -310,
        "y": 210
      }
    },
    {
      "type": "outputNode",
      "id": "408b703f-302c-4dea-bf80-e9f1996bb448",
      "name": "response",
      "position": {
        "x": 665,
        "y": 100
      }
    },
    {
      "type": "outputNode",
      "id": "f38a62d5-5f1e-43b4-8c69-594815a25cf0",
      "name": "response",
      "position": {
        "x": 655,
        "y": 515
      }
    },
    {
      "type": "functionNode",
      "content": {
        "source": "import zen from 'zen';\r\n\r\nexport const handler = async (input) => {\r\n  console.log(input)\r\n  const {territory, ...others} = input;\r\n  others.exception_details.details = `Customer located in Territory ${territory.id} assigned to ${territory.stakeholder}`;\r\n  return others;\r\n};\r\n"
      },
      "id": "6e027681-cf63-474f-b5cc-30f7eaa5f0ca",
      "name": "Exception details",
      "position": {
        "x": 1080,
        "y": 380
      }
    }
  ],
  "edges": [
    {
      "id": "562c5ef8-1a0a-426d-a4cb-ffd612f09ea7",
      "sourceId": "84b2b5e6-846b-44cb-bd18-264a35cc7b90",
      "type": "edge",
      "targetId": "1fc3f0ab-edce-4469-950e-c24299bb4030",
      "sourceHandle": "993b48ec-daa0-483c-a58f-a49c451afea4"
    },
    {
      "id": "5f9322b8-e87d-4054-8208-e3d0c9841d68",
      "sourceId": "84b2b5e6-846b-44cb-bd18-264a35cc7b90",
      "type": "edge",
      "targetId": "8bd6f144-e3dc-44b2-b98e-024e440be7b7",
      "sourceHandle": "831bbd95-677f-4005-a71c-215fb4d12308"
    },
    {
      "id": "3cc789d6-c9fb-4cc0-b339-4de730aaa73f",
      "sourceId": "bd32d1bd-a6ad-445c-b64c-8d877785a0d1",
      "type": "edge",
      "targetId": "a5f6f0b5-cba9-4887-9e85-34bc1d348053"
    },
    {
      "id": "485caaf0-2847-4784-8a45-e1f60220269c",
      "sourceId": "84b2b5e6-846b-44cb-bd18-264a35cc7b90",
      "type": "edge",
      "targetId": "32ec2919-9a0c-4e95-8931-a378c4eb727e",
      "sourceHandle": "d57dc7c1-1968-4f49-91ee-3b99b0fe6480"
    },
    {
      "id": "63518ba4-379f-4ac2-b28b-7803dac48af6",
      "sourceId": "32ec2919-9a0c-4e95-8931-a378c4eb727e",
      "type": "edge",
      "targetId": "c8bb6bb8-a695-4663-9a83-1cf77d50b678"
    },
    {
      "id": "a3820155-1233-4b26-9d60-15308f971567",
      "sourceId": "c8bb6bb8-a695-4663-9a83-1cf77d50b678",
      "type": "edge",
      "targetId": "bd32d1bd-a6ad-445c-b64c-8d877785a0d1",
      "sourceHandle": "373ecbf9-fbb2-4261-a8d2-18ab634d6cbe"
    },
    {
      "id": "9b683198-4923-45ac-8e35-dbbcbc00ef9b",
      "sourceId": "808430da-4cf5-47a7-8fb0-5061fc5efa33",
      "type": "edge",
      "targetId": "bc18866a-d4f9-4fff-9e2d-3c73a9a557f5"
    },
    {
      "id": "780220d1-ae2b-478c-b887-d4a436a37b38",
      "sourceId": "bc18866a-d4f9-4fff-9e2d-3c73a9a557f5",
      "type": "edge",
      "targetId": "84b2b5e6-846b-44cb-bd18-264a35cc7b90"
    },
    {
      "id": "654d8419-c441-4055-a6ad-8c9162ba72fe",
      "sourceId": "1fc3f0ab-edce-4469-950e-c24299bb4030",
      "type": "edge",
      "targetId": "408b703f-302c-4dea-bf80-e9f1996bb448"
    },
    {
      "id": "b22d78e8-f41b-43f4-b93d-aa4803b22f03",
      "sourceId": "8bd6f144-e3dc-44b2-b98e-024e440be7b7",
      "type": "edge",
      "targetId": "f38a62d5-5f1e-43b4-8c69-594815a25cf0"
    },
    {
      "id": "f509302b-9537-479b-92fc-0eede9ac6881",
      "sourceId": "c8bb6bb8-a695-4663-9a83-1cf77d50b678",
      "type": "edge",
      "targetId": "6e027681-cf63-474f-b5cc-30f7eaa5f0ca",
      "sourceHandle": "8019b1a5-cf97-479f-9b65-795d5f9b62a8"
    },
    {
      "id": "1cac5c3f-ec3a-439c-8f55-b99587527498",
      "sourceId": "6e027681-cf63-474f-b5cc-30f7eaa5f0ca",
      "type": "edge",
      "targetId": "a5f6f0b5-cba9-4887-9e85-34bc1d348053"
    }
  ]
}